<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ESP8266 - Mode AP</title><link rel="shortcut icon" href="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjQ4MHB0IiB2aWV3Qm94PSIwIDAgNDgwIDQ4MCIgd2lkdGg9IjQ4MHB0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im00MzIgMjQwYzAgMTA2LjAzOTA2Mi04NS45NjA5MzggMTkyLTE5MiAxOTJzLTE5Mi04NS45NjA5MzgtMTkyLTE5MiA4NS45NjA5MzgtMTkyIDE5Mi0xOTIgMTkyIDg1Ljk2MDkzOCAxOTIgMTkyem0wIDAiIGZpbGw9IiNjZmQyZmMiLz48cGF0aCBkPSJtMjQwIDQ4MGMtMTMyLjU0Njg3NSAwLTI0MC0xMDcuNDUzMTI1LTI0MC0yNDBzMTA3LjQ1MzEyNS0yNDAgMjQwLTI0MCAyNDAgMTA3LjQ1MzEyNSAyNDAgMjQwYy0uMTQ4NDM4IDEzMi40ODQzNzUtMTA3LjUxNTYyNSAyMzkuODUxNTYyLTI0MCAyNDB6bTAtNDY0Yy0xMjMuNzEwOTM4IDAtMjI0IDEwMC4yODkwNjItMjI0IDIyNHMxMDAuMjg5MDYyIDIyNCAyMjQgMjI0IDIyNC0xMDAuMjg5MDYyIDIyNC0yMjRjLS4xNDA2MjUtMTIzLjY1MjM0NC0xMDAuMzQ3NjU2LTIyMy44NTkzNzUtMjI0LTIyNHptMCAwIiBmaWxsPSIjODY5MGZhIi8+PHBhdGggZD0ibTM1MiAyNDBjMCA2MS44NTU0NjktNTAuMTQ0NTMxIDExMi0xMTIgMTEycy0xMTItNTAuMTQ0NTMxLTExMi0xMTIgNTAuMTQ0NTMxLTExMiAxMTItMTEyIDExMiA1MC4xNDQ1MzEgMTEyIDExMnptMCAwIiBmaWxsPSIjNTE1M2ZmIi8+PC9zdmc+"><style>.viewer{transition:background .2s ease-in-out}html{color:#334155;font-family:sans-serif,Arial,Helvetica;user-select:none}.dark{color:#16161a}.dark button:active{transform:scale(.98)}.dark .state-config{background-color:#16161a}.dark .container{color:#fffffe;background-color:#16161a;box-shadow:none}.dark .viewer{background-color:#242629}.dark .form-fill-input{background-color:#fffffe}.dark .state-config{background-color:#16161a}.title{text-align:center;font-size:20px;margin-bottom:25px}.viewer{position:absolute;top:0;left:0;bottom:0;right:0;background-color:#f1f5f9;display:flex;justify-content:center;align-items:center;padding:0 2rem;flex-direction:column;margin-top:-1rem;margin-bottom:-1rem;transition:background .2s ease-in-out}.container{padding:2rem;background-color:#fff;border-radius:1rem;box-shadow:rgba(149,157,165,.2) 0 8px 24px;min-width:380px;width:380px;box-sizing:border-box;position:relative;transition:filter .2s ease-in-out,background .2s ease-in-out,height .2s linear}.form{display:grid;grid-template-rows:repeat(2,minmax(0,1fr));gap:1rem}.form-fill{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));align-items:center}.form-fill-label{font-size:15px;font-weight:700}.form-fill-input{grid-column:span 2/span 2;padding:12px 16px;outline:0;border-radius:1rem;border:none;background-color:#f1f5f9}.form-fill-input:focus{box-shadow:rgba(0,0,0,.02) 0 1px 3px 0,rgba(27,31,35,.15) 0 0 0 1px}.wrap-btn{display:flex;justify-content:flex-end;margin-top:1rem}.btn{padding:10px 14px;border-radius:14px;outline:0;border:none;font-weight:700;background-color:#f1f5f9;cursor:pointer;transition:box-shadow .1s ease}.btn:active{box-shadow:rgba(0,0,0,.02) 0 1px 3px 0,rgba(27,31,35,.15) 0 0 0 1px}.container-space{margin-top:1rem;margin-bottom:1rem}.copyright{text-align:center;font-weight:700;font-size:14px}.state-config.active{z-index:999;opacity:1}.state-config{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#fff;border-radius:1rem;display:flex;justify-content:center;align-items:center;z-index:-1;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.state-config .state{padding:16px;width:fit-content;border-radius:50%;display:flex;justify-content:center;align-items:center;fill:#fff}.state-config>div{display:flex;flex-direction:column;align-items:center}.state-config-sucess .wrap .state{background-color:#4ade80}.state-config-error .wrap .state{background-color:#de4a4a}.state-config-info .wrap .state{background-color:#b9de4a}.state-config-confirm .wrap .state{background-color:#4f46e5}.state-config .message{margin-top:2rem;text-align:center;font-size:1rem;padding:0 2rem}.toggle{width:40px;height:0;padding-top:20px;background-color:#d4d4d8;border-radius:50px;position:relative;transition:background-color 150ms ease-in-out;cursor:pointer}.toggle::before{position:absolute;content:'';width:22px;height:22px;background-color:#fff;border-radius:50px;top:50%;left:0;transition:transform 150ms ease-in-out,background-color 150ms ease-in-out;transform:translate(-2px,-50%);box-shadow:rgba(0,0,0,.02) 0 1px 3px 0,rgba(27,31,35,.15) 0 0 0 1px}.toggle.active{background-color:#4f46e5}.toggle.active::before{transform:translate(20px,-50%)}.toggle--label{margin:0;font-weight:700;margin-right:1rem}.wrap-toggle{display:flex;align-items:center}header{display:flex;justify-content:space-between}.wrap-btn--right{justify-content:flex-end;width:100%;padding:0 2rem;box-sizing:border-box}.wrap-btn--right button{margin-left:1rem}.container.disable{animation:disable-area .2s forwards}.container.cancel{display:none}@keyframes disable-area{from{opacity:1}99%{opacity:0}100%{opacity:0;visibility:hidden}}.area-networks .title{font-size:1rem;text-align:left;margin:0;margin-bottom:1.5rem}.network{display:flex;align-items:center;padding:15px;border-radius:6px;background-color:#f1f5f9;transition:background 150ms ease-in-out;cursor:pointer;margin:10px 0}.network:hover{background-color:#e1e5e8}.network .name{flex:1;font-size:.9rem;margin-left:1rem;font-weight:700;max-width:150px;text-overflow:ellipsis;white-space:nowrap}.network .quality{font-size:.9rem}.network .goto{margin-left:2rem}.wrap-networks{margin:-10px 0;max-height:300px;overflow-y:scroll;padding:10px}.container.area-config,.container.area-network{box-shadow:none}.wrap-networks::-webkit-scrollbar{display:none}.wrap-main::-webkit-scrollbar{display:none}.wrap-main{display:flex;flex-wrap:nowrap;overflow-x:scroll;max-width:380px;background-color:#fff;border-radius:1rem;position:relative}.wrap-loading{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.wrap-loading p{font-weight:600}.wrap-loading .cut{width:30px;height:30px;background-color:#fff;position:absolute;z-index:2;top:-5px;left:15px}.btn-back{top:1rem;left:1rem;font-size:.7rem;width:fit-content}.loading{margin:0 auto;width:40px;height:40px;border:5px solid #d4d4d8;border-radius:50px;position:relative;animation:loading 1s infinite forwards linear}@keyframes loading{from{transform:rotate(0)}to{transform:rotate(360deg)}}</style></head><body><div class="viewer"><header class="container container-space"><div class="wrap-toggle"><p class="toggle--label">Đổi theme</p><div class="toggle toggle--theme"></div></div><div><button class="btn btn--reset-config">Reset cấu hình</button></div></header><main class="wrap-main"><main class="container area-networks"><h3 class="title">Mạng xung quanh</h3><div class="wrap-networks"></div></main><main class="container area-config"><div class="btn btn-back">&lt; back</div><h2 class="title">Cấu hình kết nối WIFIs</h2><div class="form"><div class="form-fill"><label class="form-fill-label" for="ssid">Tên</label> <input class="form-fill-input" placeholder="ví dụ: miru" type="text" name="ssid" id="ssid"></div><div class="form-fill"><label class="form-fill-label" for="password">Mật khẩu</label> <input class="form-fill-input" placeholder="-- mật khẩu sẽ bị ẩn --" type="password" name="password" id="password"></div></div><div class="wrap-btn"><button class="btn btn-config">Cấu hình</button></div></main><div class="state-config state-config-error"><div class="wrap"><div class="state"><svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="40" height="40"><path d="M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,22A10,10,0,1,1,22,12,10.011,10.011,0,0,1,12,22Z"/><path d="M12,10H11a1,1,0,0,0,0,2h1v6a1,1,0,0,0,2,0V12A2,2,0,0,0,12,10Z"/><circle cx="12" cy="6.5" r="1.5"/></svg></div><h3 class="message">Có lỗi xảy ra khi cấu hình kết nối tới wifi<br><span>[ miru ]</span></h3></div></div><div class="state-config state-config-sucess"><div class="wrap"><div class="state"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 507.506 507.506" style="enable-background:new 0 0 507.506 507.506" xml:space="preserve" width="40" height="40"><g><path d="M163.865,436.934c-14.406,0.006-28.222-5.72-38.4-15.915L9.369,304.966c-12.492-12.496-12.492-32.752,0-45.248l0,0   c12.496-12.492,32.752-12.492,45.248,0l109.248,109.248L452.889,79.942c12.496-12.492,32.752-12.492,45.248,0l0,0   c12.492,12.496,12.492,32.752,0,45.248L202.265,421.019C192.087,431.214,178.271,436.94,163.865,436.934z"/></g></svg></div><h3 class="message">Bạn đã cấu hình kết nối tới wifi<br><span>[ miru ]</span><br>thành công</h3></div></div><div class="state-config state-config-confirm"><div class="wrap"><div class="state"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" width="40" height="40"><g><path d="M256,0C114.615,0,0,114.615,0,256s114.615,256,256,256s256-114.615,256-256C511.847,114.678,397.322,0.153,256,0z M256,448   c-106.039,0-192-85.961-192-192S149.961,64,256,64s192,85.961,192,192C447.882,361.99,361.99,447.882,256,448z"/><path d="M256,321.941c17.673,0,32-14.327,32-32V140.608c0-17.673-14.327-32-32-32s-32,14.327-32,32v149.333   C224,307.614,238.327,321.941,256,321.941z"/><circle cx="256.107" cy="373.333" r="32"/></g></svg></div><h3 class="message"></h3><div class="wrap-btn wrap-btn--right"><button class="btn btn-cancel-confirm">Huỷ</button> <button class="btn btn-accept-confirm">Xác nhận</button></div></div></div><div class="state-config state-config-info"><div class="wrap"><div class="state"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" width="40" height="40"><g><path d="M256,0C114.615,0,0,114.615,0,256s114.615,256,256,256s256-114.615,256-256C511.847,114.678,397.322,0.153,256,0z M256,448   c-106.039,0-192-85.961-192-192S149.961,64,256,64s192,85.961,192,192C447.882,361.99,361.99,447.882,256,448z"/><path d="M256,321.941c17.673,0,32-14.327,32-32V140.608c0-17.673-14.327-32-32-32s-32,14.327-32,32v149.333   C224,307.614,238.327,321.941,256,321.941z"/><circle cx="256.107" cy="373.333" r="32"/></g></svg></div><h3 class="message"></h3><div class="wrap-btn"><button class="btn btn-accept-error">Xác nhận</button></div></div></div></main><footer class="container container-space"><p class="copyright">Bản quyền của @miru ngày 29/10/2022</p></footer></div></body><script>const tagTheme="miru-theme",eleSSID=document.querySelector(".form-fill-input[name=ssid]"),elePASSWORD=document.querySelector(".form-fill-input[name=password]"),eleBtnConfig=document.querySelector(".btn-config"),eleBtnBack=document.querySelector(".btn-back"),eleBtnResetConfig=document.querySelector(".btn--reset-config"),eleBtnAcceptInfo=document.querySelector(".btn-accept-error"),eleConfigInfo=document.querySelector(".state-config-info"),eleConfigError=document.querySelector(".state-config-error"),eleConfigConfirm=document.querySelector(".state-config-confirm"),eleConfigSuccess=document.querySelector(".state-config-sucess"),eleToggle=document.querySelectorAll(".toggle"),btnConfirmAccept=eleConfigConfirm.querySelector(".btn-accept-confirm"),btnConfirmCancel=eleConfigConfirm.querySelector(".btn-cancel-confirm"),eleEreaNetwork=document.querySelector(".container.area-networks"),eleEreaConfig=document.querySelector(".container.area-config"),eleWrapNetwork=document.querySelector(".wrap-networks"),eleWrapMain=document.querySelector(".wrap-main"),mainScrollEnd=eleWrapMain.scrollWidth,scanNetworksTemplate=`<div class="wrap-loading">
    <div class="loading">
      <div class="cut"></div>
    </div>
    <p>Đang quét mạng...</p>
  </div>`,IconWifi=`<svg id="Layer_1" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"
  data-name="Layer 1">
  <path
    d="m11 23a1 1 0 1 1 1 1 1 1 0 0 1 -1-1zm4.535-3.536a5 5 0 0 0 -7.07 0l1.414 1.414a3.074 3.074 0 0 1 4.242 0zm2.829-2.828a9.01 9.01 0 0 0 -12.728 0l1.414 1.414a7.011 7.011 0 0 1 9.9 0zm-.574-9.427a8 8 0 0 0 -15.79 1.791 7.912 7.912 0 0 0 .9 3.671 5.49 5.49 0 0 0 2.6 10.329h3.5c0-.053.013-.1.016-.156l-1.844-1.844h-1.672a3.491 3.491 0 0 1 -.872-6.874l1.4-.362.028-.016-.878-1.185a5.939 5.939 0 0 1 -1.178-3.563 6 6 0 0 1 11.939-.8l.1.758.759.1a5.992 5.992 0 0 1 .1 11.864l-1.919 1.92c0 .053.016.1.016.156h1a8 8 0 0 0 1.795-15.789z" />
</svg>`,IconNext=`<svg class="goto" xmlns="http://www.w3.org/2000/svg" id="arrow-circle-down" viewBox="0 0 24 24" width="20"
height="20">
<path
  d="M19.5,0H4.5C2.019,0,0,2.019,0,4.5v15c0,2.481,2.019,4.5,4.5,4.5h15c2.481,0,4.5-2.019,4.5-4.5V4.5c0-2.481-2.019-4.5-4.5-4.5Zm3.5,19.5c0,1.93-1.57,3.5-3.5,3.5H4.5c-1.93,0-3.5-1.57-3.5-3.5V4.5c0-1.93,1.57-3.5,3.5-3.5h15c1.93,0,3.5,1.57,3.5,3.5v15Z" />
<path
  d="M16.613,9.528l-2.828-2.879c-.194-.197-.51-.2-.707-.006-.197,.194-.2,.51-.006,.708l2.831,2.882c.187,.187,.448,.473,.715,.774,.131,.148,.224,.316,.286,.493H6.5c-.276,0-.5,.224-.5,.5s.224,.5,.5,.5h10.404c-.063,.177-.155,.345-.287,.493-.266,.301-.527,.587-.717,.777l-2.828,2.879c-.194,.197-.191,.514,.006,.708,.098,.095,.224,.143,.351,.143,.129,0,.259-.05,.356-.149l2.825-2.876c.198-.198,.475-.5,.756-.818,.837-.944,.837-2.368,0-3.312-.282-.318-.559-.621-.753-.815Z" />
</svg>`;function handleBack(){eleWrapMain.scrollTo({behavior:"smooth",left:0})}async function handleSendConfig(e){try{eleWrapMain.scrollTo({behavior:"smooth",left:0}),eleSSID.value.length&&elePASSWORD.value.length?"CONFIGURATION WIFI SUCCESSFULLY"===(await(await fetch("/config",{method:"POST",body:JSON.stringify({ssid:eleSSID.value,password:elePASSWORD.value}),headers:{"Content-Type":"application/json"}})).json()).message&&eleConfigSuccess.classList.add("active"):alertInfo("[Thông tin]: Bạn không được bỏ trống dữ liệu")}catch(e){console.log(e)}}function activeConfirm({message:e=""}){eleConfigConfirm.querySelector(".message").innerHTML=e,eleConfigConfirm.classList.add("active")}async function handleAcceptConfirm(){try{eleConfigConfirm.classList.remove("active");var e=await fetch("/reset-config",{method:"POST"}),t=await e.json();200<=e.status&&e.status<=300?"RESET CONFIG SUCCESSFULLY"===t.message&&(alertInfo("[Thông tin]: Bạn đã reset cấu hình WIFI thành công"),eleConfigSuccess.classList.remove("active")):alertInfo("[Thông tin]: Bạn không có quyền cấu hình")}catch(e){alertInfo("[Lỗi]: không thể reset cấu hình WIFI")}}function handleCancelConfirm(e,t){eleConfigConfirm.classList.remove("active")}function handleAcceptInfo(){eleConfigInfo.classList.remove("active")}function alertInfo(e=""){eleConfigInfo.querySelector(".message").innerHTML=e,eleConfigInfo.classList.add("active")}function setTheme(e="light"){document.body.parentNode.classList.remove("dark","light"),document.body.parentNode.classList.add(e),localStorage.setItem(tagTheme,e)}function hanldeToggle(e){e=e.target;e.className.includes("active")?(e.classList.remove("active"),setTheme("light")):(e.classList.add("active"),setTheme("dark"))}async function handleResetConfig(){eleWrapMain.scrollTo({behavior:"smooth",left:0}),activeConfirm({message:"[Chú ý]: Bạn có chắc muốn đặt lại cấu hình WIFI?"})}function activeScanNetwork(){eleWrapNetwork.innerHTML=scanNetworksTemplate}function disableScanNetwork(){eleWrapNetwork.innerHTML=""}async function scanNetworks(){try{activeScanNetwork();var e=await(await fetch("/scan-network")).json();return e?.networks?e.networks:null}catch(e){throw console.log(e),e}}async function sleep(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}function activeErrorMessage(e){eleConfigError.querySelector(".message").innerHTML=e,eleConfigError.classList.add("active")}function disableErrorMessage(){eleConfigError.classList.remove("active")}const initState=async()=>{try{if("WIFI HAS BEEN CONFIG"===(await(await fetch("/is-config")).json()).message)eleConfigSuccess.classList.add("active");else{let e=await scanNetworks();null!==e&&(disableScanNetwork(),(e=e.map(e=>({...e,quality:Math.min(Math.max(2*(e.quality+100),0),100)})).sort((e,t)=>t.quality-e.quality)).forEach(e=>{eleWrapNetwork.innerHTML+=`
            <div data-name="${e.name}" data-quality="${e.quality}" class="network">
              ${IconWifi}
              <span class="name">${e.name}</span>
              <span class="quality">${e.quality}%</span>
              ${IconNext}
            </div>
            `}),eleWrapNetwork.querySelectorAll(".network").forEach(e=>{e.addEventListener("click",function(){var e=this.getAttribute("data-name");eleSSID.value=e,eleWrapMain.scrollTo({behavior:"smooth",left:mainScrollEnd})})}))}}catch(e){}};eleBtnConfig.addEventListener("click",handleSendConfig),eleBtnResetConfig.addEventListener("click",handleResetConfig),eleBtnAcceptInfo.addEventListener("click",handleAcceptInfo),btnConfirmAccept.addEventListener("click",handleAcceptConfirm),eleBtnBack.addEventListener("click",handleBack),btnConfirmCancel.addEventListener("click",handleCancelConfirm),eleWrapMain.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),eleToggle.forEach(e=>{var t;e.className.includes("toggle--theme")&&(null!==(t=localStorage.getItem(tagTheme))&&"dark"==t?(e.classList.add("active"),document.body.parentNode.classList.add("dark")):document.body.parentNode.classList.add("light")),e.addEventListener("click",hanldeToggle)}),initState()</script></html>